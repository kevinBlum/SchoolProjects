<p>/*<br> * main.c<br> *<br> *  Created on: Oct 26, 2015<br> *      Author: kevin<br> */<br><br>#include &lt;errno.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;unistd.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;sys/types.h&gt;<br>#include &lt;sys/stat.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;fcntl.h&gt;<br>#include &lt;sys/procfs.h&gt;<br>#include &lt;sys/signal.h&gt;<br>#include &lt;sys/syscall.h&gt;<br>#include &lt;sys/param.h&gt;<br>#include &lt;dirent.h&gt;<br><br><br>void printStatus(long tgid);<br><br>int main(int argc, char *argv[])<br>{<br><br>    //Variable declaration for the directory pointer to /proc and dirent struct<br>    DIR* proc = opendir("/proc");<br>    struct dirent* ent;<br>    long tgid;<br><br>    //Error checking of the directory pointer proc<br>    if(proc == NULL) {<br>        perror("opendir(/proc)");<br>        return 1;<br>    }<br><br>    //While loop to read through the directory of process and pass the pid as an int to tgid<br>    while(ent = readdir(proc)) {<br><br>        //If statement to check if the dirent struct is passing an integer<br>        if(!isdigit(*ent-&gt;d_name))<br>            continue;<br><br>        //Assigns the process id to the tgid long integer<br>        tgid = strtol(ent-&gt;d_name, NULL, 10);<br><br>        //Calls the function of print status while passing the process id<br>        printStatus(tgid);<br>    }<br><br>    closedir(proc);<br><br>    exit(EXIT_SUCCESS);<br><br>}<br><br><br>void printStatus(long tgid)<br>{<br>    //Variable declaration for the strings for the file path and the line in the file and the file pointer<br>    char path[40], line[100], *p;<br>    FILE* statusf;<br><br>    //snprintf is used to print the tgid process ID using the path of /proc/[pid]/status<br>    snprintf(path, 40, "/proc/%ld/status", tgid);<br><br>    //opens the file from the directory using fopen to the FILE* statusf<br>    statusf = fopen(path, "r");<br><br>    //while statement that uses fgets to call the line from the file of statusf<br>    while(fgets(line, 100, statusf)) {<br><br>        //If statement that does a string compare of the line for the state<br>        if(strncmp(line, "State:", 6) != 0)<br>            continue;<br><br>        //Formatting for the line<br>        p = line + 7;<br>        while(isspace(*p)) ++p;<br><br>        //Final printf used to print the formatted line of the status for the process<br>        printf("%6d %s", tgid, p);<br>        break;<br>    }<br><br>    fclose(statusf);<br><br>}</p>
